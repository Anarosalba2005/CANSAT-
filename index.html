<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OCEAN CANSAT MONITOR</title>

  <!-- load external css file -->
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="wrap">
    <h1>OCEAN CANSAT MONITOR</h1>

    <div class="topbar">
      <div class="hint small">Using OpenSheet URL (JSON/CSV auto-detect). Polls every 5s.</div>

      <div class="controls">
  <input id="csvUrl" type="text" placeholder="Data URL" style="width:420px; padding:8px; border-radius:6px; background:transparent; color:inherit; border:1px solid rgba(255,255,255,0.03)"/>
  <button id="startBtn" class="btn-small">Start</button>
  <button id="stopBtn" class="btn-small">Stop</button>
</div>


    <div class="grid">
      <!-- LEFT column -->
      <div class="left">
        <!-- Speed + mini params -->
        <div class="card">
          <div style="display:flex; justify-content:space-between; align-items:center">
            <div>
              <div class="small">SPEED INDICATOR</div>
              <div id="speedVal" style="font-size:26px; font-weight:700; color:var(--accent2)">0%</div>
            </div>
            <div id="leakPill" class="status-pill">Leak: NO</div>
          </div>

          <div style="display:flex; gap:8px; margin-top:10px;">
           <div class="speed-gauge-wrap">
  <canvas id="speedGauge"></canvas>
</div>

            <div style="width:150px; display:flex; flex-direction:column; gap:8px;">
              <div class="param-row">
                <div class="small">pH</div><div id="phNow" style="font-weight:700">--</div>
              </div>
              <div class="param-row">
                <div class="small">Salinity (ppt)</div><div id="salNow" style="font-weight:700">--</div>
              </div>
              <div class="param-row">
                <div class="small">Pressure</div><div id="pressNow" style="font-weight:700">--</div>
              </div>
            </div>
          </div>
        </div>

        <!-- PARAMETER OVERVIEW (redesigned) -->
        <div class="card param-overview-card">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <div class="small">PARAMETER OVERVIEW</div>
            <div class="small">Latest values</div>
          </div>

          <div class="param-overview-grid">
            <!-- left summary -->
            <div class="param-left">
              <div class="param-row">
                <div class="small">Last Update</div>
                <div id="lastUpdate" class="ov-value">--</div>
              </div>

              <div class="param-row">
                <div class="small">Leak Status</div>
                <div id="ovLeak" class="ov-leak no">None</div>
              </div>

              <!-- compact list on left (we will keep but it's the redesigned single column) -->
              <div style="margin-top:8px; border-radius:8px; overflow:hidden; background:linear-gradient(180deg, rgba(0,0,0,0.02), rgba(255,255,255,0.01));">
                <div class="param-row"><div class="small">Pressure</div><div class="ov-value" id="ovPress">--</div></div>
                <div class="param-row"><div class="small">Turbidity</div><div class="ov-value" id="ovTurb">--</div></div>
                <div class="param-row"><div class="small">Salinity</div><div class="ov-value" id="ovSal">--</div></div>
                <div class="param-row"><div class="small">pH</div><div class="ov-value" id="ovPH">--</div></div>
              </div>
            </div>

            <!-- right larger column (big values) -->
            <div class="param-right">
              <div style="display:flex; justify-content:flex-start; gap:22px; align-items:flex-start;">
                <div style="flex:1">
                  <div class="small" style="text-align:left">pH</div>
                  <div class="ov-value big" id="ovPH_big">--</div>
                </div>

                <div style="flex:1">
                  <div class="small" style="text-align:left">Salinity (ppt)</div>
                  <div class="ov-value big" id="ovSal_big">--</div>
                </div>
              </div>

              <div style="display:flex; justify-content:flex-start; gap:22px; margin-top:10px;">
                <div style="flex:1">
                  <div class="small">Pressure</div>
                  <div class="ov-value big" id="ovPress_big">--</div>
                </div>

                <div style="flex:1">
                  <div class="small">Turbidity</div>
                  <div class="ov-value big" id="ovTurb_big">--</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- TREND CHARTS -->
        <div class="card">
          <div style="display:flex; justify-content:space-between; align-items:center;">
            <div class="small">TREND CHARTS</div>
            <div class="small">Last 100 rows</div>
          </div>

          <div class="trend-grid" style="margin-top:10px;">
            <div class="trend-card">
              <div class="trend-title">pH level</div>
              <canvas id="phTrend" style="height:120px"></canvas>
            </div>

            <div class="trend-card">
              <div class="trend-title">Salinity level</div>
              <canvas id="salTrend" style="height:120px"></canvas>
            </div>

            <div class="trend-card">
              <div class="trend-title">Pressure level</div>
              <canvas id="pressTrend" style="height:120px"></canvas>
            </div>

            <div class="trend-card">
              <div class="trend-title">Turbidity level</div>
              <canvas id="turbTrend" style="height:120px"></canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- RIGHT column -->
      <div class="right-col">
        <div class="card big-widget">
          <div style="width:100%;">
            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
              <div class="small">3D SIMULATION</div>
              <div class="small">Depth: <span id="depthNow">--</span></div>
            </div>

            <div class="sim-wrap" aria-hidden="false">
              <div class="cansat-glow" aria-hidden="true"></div>

              <!-- image placed in same folder, change name if different -->
              <img src="cansat.jpg" id="cansatImg" class="cansat-img cansat-anim" alt="CANSAT Underwater">

              <div class="shimmer" aria-hidden="true"></div>

              <div class="bubble-layer" aria-hidden="true">
                <div class="bubble xs b1" style="left:10%; animation-duration:9s;"></div>
                <div class="bubble sm b2" style="left:25%; animation-duration:12s;"></div>
                <div class="bubble lg b3" style="left:42%; animation-duration:8s;"></div>
                <div class="bubble sm b4" style="left:58%; animation-duration:13s;"></div>
                <div class="bubble xs b5" style="left:72%; animation-duration:10s;"></div>
                <div class="bubble sm b6" style="left:86%; animation-duration:7s;"></div>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px">
            <div class="small">RECENT RECORDS</div>
            <div class="small">Rows: <span id="rowCount">0</span></div>
          </div>
          <div style="max-height:260px; overflow:auto;">
            <table id="recordsTable">
              <thead><tr><th>ts</th><th>pH</th><th>sal</th><th>press</th><th>turb</th><th>leak</th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

      </div>
    </div>

  </div>

  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <!-- app script -->
  <script src="app.js"></script>
</body>
</html>
